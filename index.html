<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guild Boss Loot</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">

<div class="flex justify-between items-center mb-4">
  <h1 class="text-2xl font-bold">Guild Boss Loot</h1>
  <button id="admin-btn" class="bg-indigo-600 text-white px-3 py-1 rounded">Admin</button>
</div>

<div class="p-4 bg-white border rounded-md">
  <h2 class="text-xl font-semibold mb-2">Recorded Loot Entries</h2>
  <div id="loot-list" class="space-y-3"></div>
</div>

<!-- Admin Login Modal -->
<div id="admin-login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
  <div class="bg-white p-4 rounded-lg w-80">
    <h3 class="font-bold mb-2">Admin Login</h3>
    <div id="first-time-admin" class="mb-2">
      <p class="mb-1">Set Admin Phrase:</p>
      <input id="new-admin-phrase" type="text" placeholder="Enter phrase" class="border p-1 rounded w-full mb-2">
      <button id="save-admin-phrase-btn" class="bg-green-500 text-white px-3 py-1 rounded w-full">Save Phrase</button>
    </div>
    <div id="existing-admin-login" class="mb-2 hidden">
      <p class="mb-1">Enter Admin Phrase:</p>
      <input id="admin-phrase-input" type="text" placeholder="Admin phrase" class="border p-1 rounded w-full mb-2">
      <button id="admin-login-btn" class="bg-indigo-600 text-white px-3 py-1 rounded w-full">Login</button>
    </div>
    <button id="close-admin-login" class="bg-gray-300 px-3 py-1 rounded w-full mt-2">Close</button>
  </div>
</div>

<script type="module">
import './view.js';

const adminBtn = document.getElementById('admin-btn');
const adminLoginModal = document.getElementById('admin-login-modal');
const firstTimeDiv = document.getElementById('first-time-admin');
const existingLoginDiv = document.getElementById('existing-admin-login');
const saveAdminBtn = document.getElementById('save-admin-phrase-btn');
const adminLoginBtn = document.getElementById('admin-login-btn');
const adminPhraseInput = document.getElementById('admin-phrase-input');
const newAdminPhraseInput = document.getElementById('new-admin-phrase');
const closeLoginBtn = document.getElementById('close-admin-login');

let storedPhrase = localStorage.getItem('adminPhrase');

function showLoginModal(){
    adminLoginModal.style.display='flex';
    if(!storedPhrase){
        firstTimeDiv.style.display='block';
        existingLoginDiv.style.display='none';
    }else{
        firstTimeDiv.style.display='none';
        existingLoginDiv.style.display='block';
    }
}

adminBtn.addEventListener('click', ()=>{ showLoginModal(); });
closeLoginBtn.addEventListener('click', ()=>{ adminLoginModal.style.display='none'; });

saveAdminBtn.addEventListener('click', ()=>{
    const phrase = newAdminPhraseInput.value.trim();
    if(!phrase) return alert('Enter a phrase');
    localStorage.setItem('adminPhrase', phrase);
    storedPhrase = phrase;
    alert('Admin phrase saved');
    adminLoginModal.style.display='none';
});

adminLoginBtn.addEventListener('click', ()=>{
    const input = adminPhraseInput.value.trim();
    if(input===storedPhrase){
        window.location.href='admin.html';
    }else{
        alert('Incorrect phrase');
    }
});
</script>

</body>
</html>